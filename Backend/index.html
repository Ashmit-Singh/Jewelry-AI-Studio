<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuxeLens AI Studio</title>
    <!-- Tailwind CSS CDN - This replaces all Node.js/npm/npx setup for Tailwind! -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom styles to match LuxeLens theme */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a; /* Deep black background */
            color: #d4d4d4; /* Light gray text */
        }
        /* Custom spinner for loading indication */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border-left-color: #fff;
            animation: spin 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Custom file input styling */
        .custom-file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            max-width: 320px;
            height: 56px; /* Taller for better touch targets */
            background-color: #262626; /* Darker background */
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            overflow: hidden;
            transition: box-shadow 0.2s ease-in-out, border-color 0.2s ease-in-out;
            border: 1px solid #404040; /* Darker border */
        }
        .custom-file-input-wrapper:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            border-color: #525252;
        }
        .custom-file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 2;
        }
        .custom-file-label {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            height: 100%;
            padding: 0 16px;
            font-weight: 500;
            color: #a3a3a3; /* Light gray text */
            background-color: #262626;
            pointer-events: none;
        }
        .custom-file-label::before {
            content: 'Choose File'; /* Updated button text */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to right, #2563eb, #3b82f6); /* Blue gradient */
            color: white;
            padding: 12px 20px; /* More padding */
            border-radius: 8px;
            font-weight: 600;
            margin-right: 12px;
            box-shadow: 0 2px 8px rgba(37,99,235,0.4);
            transition: all 0.2s ease-in-out;
            height: calc(100% - 16px);
        }
        .custom-file-input:hover + .custom-file-label::before {
            background: linear-gradient(to right, #1d4ed8, #2563eb); /* Darker blue on hover */
            box-shadow: 0 4px 12px rgba(37,99,235,0.5);
        }
        .file-name {
            flex-grow: 1;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            font-size: 1rem;
            color: #d4d4d4;
        }

        /* Button styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px; /* Full rounded for pill shape */
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .btn-primary {
            background: linear-gradient(to right, #3b82f6, #2563eb); /* Blue gradient */
            color: white;
            padding: 1rem 2.5rem; /* Large padding */
            font-size: 1.25rem; /* Large text */
        }
        .btn-primary:hover {
            background: linear-gradient(to right, #2563eb, #1d4ed8);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }
        .btn-outline {
            background-color: #262626; /* Dark background */
            color: #a3a3a3; /* Light text */
            border: 1px solid #404040; /* Dark border */
            padding: 1rem 2.5rem;
            font-size: 1.25rem;
        }
        .btn-outline:hover {
            background-color: #404040;
            border-color: #525252;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        /* Card styles */
        .card {
            background-color: #171717; /* Darker background for cards */
            border: 1px solid #262626; /* Dark border */
            border-radius: 1.5rem; /* More rounded */
            box-shadow: 0 10px 30px rgba(0,0,0,0.4); /* Stronger shadow */
            padding: 3rem;
        }

        /* Progress Bar */
        .progress-root {
            position: relative;
            height: 8px;
            width: 100%;
            overflow: hidden;
            border-radius: 9999px;
            background-color: #404040; /* Darker background */
        }
        .progress-indicator {
            height: 100%;
            width: 100%;
            background-color: #3b82f6; /* Blue indicator */
            transition: transform 0.3s ease-out;
        }

        /* Badge styles */
        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 9999px;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .badge-secondary {
            background-color: #404040;
            color: #a3a3a3;
            border: 1px solid #525252;
        }
        .badge-destructive {
            background-color: #ef4444;
            color: white;
            border: 1px solid #dc2626;
        }

        /* Specific LuxeLens styles from original UI */
        .header-bg {
            background: linear-gradient(to bottom, #171717, #0a0a0a);
        }
        .icon-circle {
            background-color: #262626;
            border: 1px solid #404040;
        }
        .feature-card {
            background-color: #171717;
            border: 1px solid #262626;
        }
        .feature-icon-bg-blue { background-color: #2563eb; }
        .feature-icon-bg-green { background-color: #22c55e; }
        .feature-icon-bg-purple { background-color: #a855f7; }

        .result-image-border {
            border: 4px solid #3b82f6; /* Blue border for enhanced image */
        }
        .defect-overlay {
            border: 2px solid #ef4444;
            background-color: rgba(239, 68, 68, 0.2);
        }
        .defect-overlay:hover {
            background-color: rgba(239, 68, 68, 0.3);
        }
        .defect-label {
            background-color: #ef4444;
            color: white;
        }
        .analysis-score-text {
            color: #22c55e; /* Green for authenticity */
        }
        .defects-found-text {
            color: #f97316; /* Orange for defects */
        }
        .processing-time-text {
            color: #3b82f6; /* Blue for processing time */
        }
        .defect-detail-item {
            background-color: #171717;
            border: 1px solid #262626;
        }
        .defect-detail-item.selected {
            border-color: #ef4444;
            background-color: rgba(239, 68, 68, 0.1);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="header-bg border-b border-zinc-800">
        <div class="max-w-7xl mx-auto px-6 py-20">
            <div class="text-center">
                <div class="flex items-center justify-center gap-6 mb-8">
                    <div class="relative">
                        <div class="p-6 icon-circle rounded-3xl shadow-2xl">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gem text-white">
                                <path d="M6 3h12l4 6-10 13L2 9Z"/>
                                <path d="m12 17 5-5 4 6"/>
                                <path d="M2 9l4 6 5-5"/>
                                <path d="M22 9 12 22 2 9"/>
                            </svg>
                        </div>
                        <div class="absolute -top-1 -right-1 p-2 bg-white rounded-full shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles text-black">
                                <path d="M9.9 10.8a3 3 0 1 0 5.2 0"/>
                                <path d="M12 2v4"/>
                                <path d="M12 18v4"/>
                                <path d="M2 12h4"/>
                                <path d="M18 12h4"/>
                                <path d="m19.5 4.5-2.1 2.1"/>
                                <path d="m6.6 17.4-2.1 2.1"/>
                                <path d="m4.5 4.5 2.1 2.1"/>
                                <path d="m17.4 17.4 2.1 2.1"/>
                            </svg>
                        </div>
                    </div>
                    <div class="text-left">
                        <h1 class="text-6xl font-bold text-white tracking-tight">LuxeLens</h1>
                        <div class="w-24 h-1 bg-gradient-to-r from-zinc-400 to-zinc-600 mx-auto mt-6 mb-8 rounded-full"></div>
                    </div>
                </div>
                <p class="text-zinc-400 text-2xl font-light max-w-4xl mx-auto leading-relaxed">
                    Revolutionary AI-powered luxury jewelry analysis platform. Upload your precious pieces for instant defect
                    detection, authenticity verification, and professional-grade image enhancement.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto mt-12">
                    <div class="flex flex-col items-center gap-4 p-6 rounded-2xl feature-card">
                        <div class="p-4 rounded-2xl shadow-lg feature-icon-bg-blue">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scan-line text-white">
                                <path d="M3 7V5a2 2 0 0 1 2-2h2"/>
                                <path d="M17 3h2a2 2 0 0 1 2 2v2"/>
                                <path d="M21 17v2a2 2 0 0 1-2 2h-2"/>
                                <path d="M7 21H5a2 2 0 0 1-2-2v-2"/>
                                <line x1="7" x2="17" y1="12" y2="12"/>
                            </svg>
                        </div>
                        <div class="text-center">
                            <h3 class="text-lg font-semibold text-white mb-2">AI Detection</h3>
                            <p class="text-zinc-400 text-sm">Advanced computer vision for precise defect identification</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-center gap-4 p-6 rounded-2xl feature-card">
                        <div class="p-4 rounded-2xl shadow-lg feature-icon-bg-green">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-award text-white">
                                <circle cx="12" cy="8" r="6"/>
                                <path d="M15.477 12.89L17.18 21l-5.152-3.623L6.82 21l1.703-8.11"/>
                            </svg>
                        </div>
                        <div class="text-center">
                            <h3 class="text-lg font-semibold text-white mb-2">Authenticity</h3>
                            <p class="text-zinc-400 text-sm">Professional-grade verification with confidence scoring</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-center gap-4 p-6 rounded-2xl feature-card">
                        <div class="p-4 rounded-2xl shadow-lg feature-icon-bg-purple">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wand-2 text-white">
                                <path d="M21 7H11"/>
                                <path d="M18.5 12.5L19 13"/>
                                <path d="M16.5 10.5L17 11"/>
                                <path d="M12.5 6.5L13 7"/>
                                <path d="M10.5 4.5L11 5"/>
                                <path d="M10 2l-2 2"/>
                                <path d="M10 22l-2-2"/>
                                <path d="M2 12h4"/>
                                <path d="M4 4l2 2"/>
                                <path d="M4 20l2-2"/>
                            </svg>
                        </div>
                        <div class="text-center">
                            <h3 class="text-lg font-semibold text-white mb-2">Enhancement</h3>
                            <p class="text-zinc-400 text-sm">Studio-quality image processing and background removal</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-16">
        <!-- Upload Section -->
        <section id="upload-section" class="card p-16 border-2 border-dashed border-zinc-700 hover:border-zinc-600 transition-all duration-300 bg-zinc-900/50 shadow-2xl hover:shadow-3xl transform hover:-translate-y-1 backdrop-blur-sm">
            <div
                class="text-center cursor-pointer group"
                id="upload-area"
            >
                <div class="relative p-8 bg-gradient-to-br from-zinc-800 to-zinc-900 rounded-full w-32 h-32 mx-auto mb-8 flex items-center justify-center shadow-xl group-hover:scale-105 transition-transform duration-300 border border-zinc-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-camera text-zinc-300 group-hover:animate-pulse">
                        <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                        <circle cx="12" cy="13" r="3"/>
                    </svg>
                    <div class="absolute -top-2 -right-2 p-2 bg-blue-600 rounded-full shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload text-white">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" x2="12" y1="3" y2="15"/>
                        </svg>
                    </div>
                </div>
                <h3 class="text-4xl font-bold text-white mb-6 tracking-tight">Upload Jewelry Image</h3>
                <p class="text-zinc-400 mb-10 text-xl font-light">
                    Drag and drop your luxury jewelry photo here, or click to browse
                </p>
                <div class="custom-file-input-wrapper mx-auto mb-4">
                    <input type="file" id="file-input" accept="image/*" class="custom-file-input">
                    <label for="file-input" class="custom-file-label">
                        <span class="file-name" id="file-name-display">No file chosen</span>
                    </label>
                </div>
                <div class="flex items-center justify-center gap-6 mt-8 text-sm text-zinc-500">
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                        </svg>
                        <span>Secure & Private</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layers">
                            <path d="m12.83 2.18-.3.9A4.3 4.3 0 0 0 8 6H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-4a4.3 4.3 0 0 0-4.53-3.82Z"/>
                            <path d="M10 12h.01"/>
                            <path d="M14 12h.01"/>
                            <path d="M10 16h.01"/>
                            <path d="M14 16h.01"/>
                        </svg>
                        <span>JPG, PNG, HEIC</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trending-up">
                            <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
                            <polyline points="16 7 22 7 22 13"/>
                        </svg>
                        <span>Up to 10MB</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Processing State -->
        <section id="processing-section" class="card p-12 bg-zinc-900/50 shadow-2xl border border-zinc-800 backdrop-blur-sm hidden">
            <div class="text-center">
                <div class="relative p-6 bg-gradient-to-br from-zinc-800 to-zinc-900 rounded-full w-24 h-24 mx-auto mb-8 flex items-center justify-center shadow-xl border border-zinc-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-zinc-300 animate-pulse">
                        <rect width="18" height="18" x="3" y="3" rx="2"/>
                        <path d="M8 8h8v8H8z"/>
                        <path d="M9 1v2"/>
                        <path d="M15 1v2"/>
                        <path d="M9 21v2"/>
                        <path d="M15 21v2"/>
                        <path d="M21 9h-2"/>
                        <path d="M21 15h-2"/>
                        <path d="M3 9h2"/>
                        <path d="M3 15h2"/>
                    </svg>
                    <div class="absolute inset-0 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"></div>
                </div>
                <h3 class="text-2xl font-bold text-white mb-6 tracking-tight" id="processing-step-text">AI is working its magic...</h3>
                <div class="w-full max-w-md mx-auto mb-8">
                    <div class="progress-root">
                        <div class="progress-indicator" id="progress-indicator" style="transform: translateX(-100%);"></div>
                    </div>
                </div>
                <p class="text-zinc-400 text-lg font-light">This may take a few moments...</p>
            </div>
        </section>

        <!-- Ready to Analyze Section -->
        <section id="ready-to-analyze-section" class="card p-12 bg-zinc-900/50 shadow-2xl border border-zinc-800 backdrop-blur-sm hidden">
            <div class="flex items-center gap-10">
                <div class="relative">
                    <img id="uploaded-jewelry-preview" src="" alt="Uploaded jewelry" class="w-48 h-48 object-cover rounded-2xl border border-zinc-700 shadow-xl" />
                    <div class="absolute top-4 left-4 p-2 bg-black/80 backdrop-blur-sm rounded-lg border border-zinc-700">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gem text-white">
                            <path d="M6 3h12l4 6-10 13L2 9Z"/>
                            <path d="m12 17 5-5 4 6"/>
                            <path d="M2 9l4 6 5-5"/>
                            <path d="M22 9 12 22 2 9"/>
                        </svg>
                    </div>
                </div>
                <div class="flex-1">
                    <h3 class="text-3xl font-bold text-white mb-4 tracking-tight">Ready to Analyze</h3>
                    <p class="text-zinc-400 mb-8 text-xl font-light">
                        Your jewelry image has been uploaded successfully. Click analyze to begin LuxeLens AI processing.
                    </p>
                    <div class="flex gap-4">
                        <button id="analyze-button" class="btn btn-primary text-lg px-8 py-4 rounded-xl font-medium transition-all duration-300 hover:scale-105">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-target mr-3">
                                <circle cx="12" cy="12" r="10"/>
                                <circle cx="12" cy="12" r="6"/>
                                <path d="M12 2a2 2 0 0 0-2 2v.5"/>
                                <path d="M12 22a2 2 0 0 0 2-2v-.5"/>
                                <path d="M2 12a2 2 0 0 0 2 2h.5"/>
                                <path d="M22 12a2 2 0 0 0-2-2h-.5"/>
                            </svg>
                            Analyze with LuxeLens
                        </button>
                        <button id="upload-different-button" class="btn btn-outline px-10 py-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload mr-3">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" x2="12" y1="3" y2="15"/>
                            </svg>
                            Upload Different Image
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analysis Results -->
        <section id="analysis-results-section" class="space-y-12 hidden">
            <!-- Image Comparison -->
            <div class="card p-12 bg-zinc-900/50 shadow-2xl border border-zinc-800 backdrop-blur-sm">
                <div class="flex items-center gap-4 mb-10">
                    <div class="p-3 bg-blue-600 rounded-2xl shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye text-white">
                            <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                    </div>
                    <h2 class="text-4xl font-bold text-white tracking-tight">Image Enhancement Results</h2>
                </div>
                <div class="grid md:grid-cols-2 gap-12">
                    <div class="group">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="p-2 bg-zinc-800 rounded-lg border border-zinc-700">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-camera text-zinc-300">
                                    <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                                    <circle cx="12" cy="13" r="3"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-medium text-zinc-300">Original Image</h3>
                        </div>
                        <div class="relative overflow-hidden rounded-2xl shadow-2xl group-hover:shadow-3xl transition-shadow duration-300">
                            <img id="original-result-image" src="" alt="Original jewelry" class="w-full h-80 object-cover" />
                            <div class="badge badge-secondary absolute top-4 left-4 bg-zinc-900/90 text-zinc-300 backdrop-blur-sm border border-zinc-700">
                                Original
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="p-2 bg-green-600 rounded-lg shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wand-2 text-white">
                                    <path d="M21 7H11"/>
                                    <path d="M18.5 12.5L19 13"/>
                                    <path d="M16.5 10.5L17 11"/>
                                    <path d="M12.5 6.5L13 7"/>
                                    <path d="M10.5 4.5L11 5"/>
                                    <path d="M10 2l-2 2"/>
                                    <path d="M10 22l-2-2"/>
                                    <path d="M2 12h4"/>
                                    <path d="M4 4l2 2"/>
                                    <path d="M4 20l2-2"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-medium text-zinc-300">Enhanced Image</h3>
                        </div>
                        <div class="relative overflow-hidden rounded-2xl shadow-2xl group-hover:shadow-3xl transition-shadow duration-300">
                            <img id="cleaned-result-image" src="" alt="Enhanced jewelry" class="w-full h-80 object-cover" />
                            <div class="badge absolute top-4 left-4 bg-white text-black shadow-lg font-medium">Enhanced</div>
                            <!-- Defect overlays will be added by JS -->
                            <div id="defect-overlays-container"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Summary -->
            <div class="grid md:grid-cols-3 gap-8">
                <div class="card p-8 bg-zinc-900/50 border border-zinc-800 shadow-2xl hover:shadow-3xl transform hover:-translate-y-1 transition-all duration-300 backdrop-blur-sm">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="p-3 bg-green-600 rounded-2xl shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-award text-white">
                                <circle cx="12" cy="8" r="6"/>
                                <path d="M15.477 12.89L17.18 21l-5.152-3.623L6.82 21l1.703-8.11"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-medium text-white">Authenticity Score</h3>
                    </div>
                    <div class="text-5xl font-bold text-white mb-3" id="authenticity-score-display"></div>
                    <p class="text-green-400 font-medium">High confidence authentic</p>
                </div>

                <div class="card p-8 bg-zinc-900/50 border border-zinc-800 shadow-2xl hover:shadow-3xl transform hover:-translate-y-1 transition-all duration-300 backdrop-blur-sm">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="p-3 bg-orange-600 rounded-2xl shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scan-line text-white">
                                <path d="M3 7V5a2 2 0 0 1 2-2h2"/>
                                <path d="M17 3h2a2 2 0 0 1 2 2v2"/>
                                <path d="M21 17v2a2 2 0 0 1-2 2h-2"/>
                                <path d="M7 21H5a2 2 0 0 1-2-2v-2"/>
                                <line x1="7" x2="17" y1="12" y2="12"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-medium text-white">Defects Found</h3>
                    </div>
                    <div class="text-5xl font-bold text-white mb-3" id="defects-found-display"></div>
                    <p class="text-orange-400 font-medium">Minor issues detected</p>
                </div>

                <div class="card p-8 bg-zinc-900/50 border border-zinc-800 shadow-2xl hover:shadow-3xl transform hover:-translate-y-1 transition-all duration-300 backdrop-blur-sm">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="p-3 bg-blue-600 rounded-2xl shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock text-white">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-medium text-white">Processing Time</h3>
                    </div>
                    <div class="text-5xl font-bold text-white mb-3" id="processing-time-display"></div>
                    <p class="text-blue-400 font-medium">Analysis completed</p>
                </div>
            </div>

            <!-- Defect Details -->
            <div id="defect-details-card" class="card p-10 bg-zinc-900/50 shadow-2xl border border-zinc-800 backdrop-blur-sm hidden">
                <div class="flex items-center gap-4 mb-8">
                    <div class="p-3 bg-red-600 rounded-2xl shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-alert-triangle text-white">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" x2="12" y1="9" y2="13"/>
                            <line x1="12" x2="12.01" y1="17" y2="17"/>
                        </svg>
                    </div>
                    <h3 class="text-3xl font-bold text-white tracking-tight">Defect Analysis</h3>
                </div>
                <div id="defect-list" class="space-y-4">
                    <!-- Defect items will be added by JS -->
                </div>
            </div>

            <!-- Export Options -->
            <div class="card p-12 bg-zinc-900/50 shadow-2xl border border-zinc-800 backdrop-blur-sm">
                <div class="flex items-center gap-4 mb-10">
                    <div class="p-3 bg-purple-600 rounded-2xl shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download text-white">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" x2="12" y1="15" y2="3"/>
                        </svg>
                    </div>
                    <h3 class="text-3xl font-bold text-white tracking-tight">Export Options</h3>
                </div>
                <div class="flex flex-wrap gap-6">
                    <button id="download-enhanced-image-button" class="btn btn-primary px-10 py-4 font-medium shadow-xl hover:shadow-2xl transform hover:-translate-y-0.5 transition-all duration-200 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download mr-3">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" x2="12" y1="15" y2="3"/>
                        </svg>
                        Download Enhanced Image
                    </button>
                    <button id="export-pdf-report-button" class="btn btn-outline px-10 py-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-image mr-3">
                            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <circle cx="10" cy="12" r="2"/>
                            <path d="m20 17-1.29-1.29a1 1 0 0 0-1.42 0L10 22h10a2 2 0 0 0 2-2v-2.5l-2-2Z"/>
                        </svg>
                        Export PDF Report
                    </button>
                    <button id="analyze-new-image-button" class="btn btn-outline px-10 py-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload mr-3">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" x2="12" y1="3" y2="15"/>
                        </svg>
                        Analyze New Image
                    </button>
                </div>
            </div>
        </section>
    </main>

    <script>
        // --- DOM Elements ---
        const uploadSection = document.getElementById('upload-section');
        const processingSection = document.getElementById('processing-section');
        const readyToAnalyzeSection = document.getElementById('ready-to-analyze-section');
        const analysisResultsSection = document.getElementById('analysis-results-section');

        const fileInput = document.getElementById('file-input');
        const fileNameDisplay = document.getElementById('file-name-display');
        const jewelryPreview = document.getElementById('uploaded-jewelry-preview');

        const processingStepText = document.getElementById('processing-step-text');
        const progressIndicator = document.getElementById('progress-indicator');

        const analyzeButton = document.getElementById('analyze-button');
        const uploadDifferentButton = document.getElementById('upload-different-button');
        const downloadEnhancedImageButton = document.getElementById('download-enhanced-image-button');
        const exportPdfReportButton = document.getElementById('export-pdf-report-button');
        const analyzeNewImageButton = document.getElementById('analyze-new-image-button');

        const originalResultImage = document.getElementById('original-result-image');
        const cleanedResultImage = document.getElementById('cleaned-result-image');
        const defectOverlaysContainer = document.getElementById('defect-overlays-container');
        const authenticityScoreDisplay = document.getElementById('authenticity-score-display');
        const defectsFoundDisplay = document.getElementById('defects-found-display');
        const processingTimeDisplay = document.getElementById('processing-time-display');
        const defectDetailsCard = document.getElementById('defect-details-card');
        const defectList = document.getElementById('defect-list');

        let uploadedFile = null;
        let analysisResult = null;
        let selectedDefect = null;

        // --- Utility Functions ---
        function showSection(sectionElement) {
            uploadSection.classList.add('hidden');
            processingSection.classList.add('hidden');
            readyToAnalyzeSection.classList.add('hidden');
            analysisResultsSection.classList.add('hidden');
            sectionElement.classList.remove('hidden');
        }

        function showUploadSection() {
            uploadedFile = null;
            analysisResult = null;
            selectedDefect = null;
            fileInput.value = '';
            fileNameDisplay.textContent = 'No file chosen';
            jewelryPreview.src = '';
            jewelryPreview.classList.add('hidden');
            showSection(uploadSection);
        }

        function showReadyToAnalyzeSection(file) {
            uploadedFile = file;
            jewelryPreview.src = URL.createObjectURL(file);
            jewelryPreview.classList.remove('hidden');
            showSection(readyToAnalyzeSection);
        }

        function showProcessingSection() {
            showSection(processingSection);
        }

        function showAnalysisResults(result) {
            analysisResult = result;
            originalResultImage.src = result.originalImage;
            cleanedResultImage.src = result.cleanedImage;
            authenticityScoreDisplay.textContent = `${result.authenticityScore}%`;
            defectsFoundDisplay.textContent = result.defects.length;
            processingTimeDisplay.textContent = `${result.processingTime}s`;

            renderDefectOverlays(result.defects);
            renderDefectDetails(result.defects);

            showSection(analysisResultsSection);
        }

        function renderDefectOverlays(defects) {
            defectOverlaysContainer.innerHTML = ''; // Clear previous overlays
            defects.forEach((defect, index) => {
                const overlayDiv = document.createElement('div');
                overlayDiv.className = `absolute defect-overlay cursor-pointer transition-all duration-200`;
                overlayDiv.style.left = `${defect.location.x}%`;
                overlayDiv.style.top = `${defect.location.y}%`;
                overlayDiv.style.width = `${defect.location.width}%`;
                overlayDiv.style.height = `${defect.location.height}%`;
                overlayDiv.dataset.defectIndex = index; // Store index to link to details

                const labelDiv = document.createElement('div');
                labelDiv.className = `absolute -top-10 left-0 defect-label text-xs px-3 py-1 rounded-lg whitespace-nowrap shadow-lg`;
                labelDiv.textContent = `${defect.type} (${defect.confidence}%)`;
                overlayDiv.appendChild(labelDiv);

                overlayDiv.addEventListener('click', () => toggleDefectSelection(defect));
                defectOverlaysContainer.appendChild(overlayDiv);
            });
        }

        function renderDefectDetails(defects) {
            defectList.innerHTML = ''; // Clear previous details
            if (defects.length > 0) {
                defectDetailsCard.classList.remove('hidden');
                defects.forEach((defect, index) => {
                    const defectItemDiv = document.createElement('div');
                    defectItemDiv.className = `p-6 rounded-2xl border cursor-pointer transition-all duration-200 defect-detail-item`;
                    if (selectedDefect === defect) {
                        defectItemDiv.classList.add('selected');
                    }
                    defectItemDiv.dataset.defectIndex = index;

                    let severityBgClass = '';
                    let severityBorderClass = '';
                    let severityTextClass = 'text-zinc-300'; // Default for secondary badge

                    if (defect.severity === 'high') {
                        severityBgClass = 'bg-red-600';
                        severityBorderClass = 'border-red-500';
                    } else if (defect.severity === 'medium') {
                        severityBgClass = 'bg-orange-600';
                        severityBorderClass = 'border-orange-500';
                    } else { // low
                        severityBgClass = 'bg-yellow-600';
                        severityBorderClass = 'border-yellow-500';
                    }


                    defectItemDiv.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-4 h-4 rounded-full shadow-lg ${severityBgClass}"></div>
                                <span class="font-medium text-white text-lg">${defect.type}</span>
                                <div class="badge badge-secondary bg-zinc-800 text-zinc-300 font-medium border border-zinc-700">
                                    ${defect.confidence}% confidence
                                </div>
                            </div>
                            <div class="badge ${severityBgClass} ${severityBorderClass} ${severityTextClass}">
                                ${defect.severity} severity
                            </div>
                        </div>
                    `;
                    defectItemDiv.addEventListener('click', () => toggleDefectSelection(defect));
                    defectList.appendChild(defectItemDiv);
                });
            } else {
                defectDetailsCard.classList.add('hidden');
            }
        }

        function toggleDefectSelection(defect) {
            selectedDefect = (selectedDefect === defect) ? null : defect;
            renderDefectDetails(analysisResult.defects); // Re-render to update selection
            updateOverlaySelection(defect);
        }

        function updateOverlaySelection(currentDefect) {
            document.querySelectorAll('.defect-overlay').forEach(overlayDiv => {
                const index = parseInt(overlayDiv.dataset.defectIndex);
                if (analysisResult.defects[index] === currentDefect) {
                    overlayDiv.classList.add('border-red-500', 'bg-red-500/40', 'shadow-lg');
                    overlayDiv.classList.remove('border-red-400/70', 'bg-red-400/20', 'hover:bg-red-400/30');
                } else {
                    overlayDiv.classList.remove('border-red-500', 'bg-red-500/40', 'shadow-lg');
                    overlayDiv.classList.add('border-red-400/70', 'bg-red-400/20', 'hover:bg-red-400/30');
                }
            });
        }


        // --- Event Handlers ---
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.type.startsWith("image/")) {
                fileNameDisplay.textContent = file.name;
                showReadyToAnalyzeSection(file);
            } else {
                alert('Please upload a valid image file (JPG, PNG, HEIC).'); // Using alert for simplicity in hackathon
                showUploadSection();
            }
        });

        // Drag and Drop
        const uploadArea = document.getElementById('upload-area');
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault(); // Prevent default to allow drop
            uploadArea.classList.add('border-blue-500', 'bg-zinc-800/50'); // Visual feedback
        });
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-blue-500', 'bg-zinc-800/50');
        });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-blue-500', 'bg-zinc-800/50');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith("image/")) {
                fileNameDisplay.textContent = file.name;
                showReadyToAnalyzeSection(file);
            } else {
                alert('Please drop a valid image file.');
                showUploadSection();
            }
        });


        analyzeButton.addEventListener('click', simulateProcessing);
        uploadDifferentButton.addEventListener('click', showUploadSection);
        downloadEnhancedImageButton.addEventListener('click', () => {
            if (analysisResult && analysisResult.cleanedImage) {
                const link = document.createElement('a');
                link.href = analysisResult.cleanedImage;
                link.download = 'luxelens-enhanced-jewelry.jpg';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('No enhanced image available to download.');
            }
        });
        exportPdfReportButton.addEventListener('click', () => {
            alert('PDF report export is a placeholder for the hackathon! (Simulated)');
            console.log('Simulating PDF report export...');
        });
        analyzeNewImageButton.addEventListener('click', showUploadSection);

        // --- Simulation Logic (Replace with actual Backend Fetch) ---
        async function simulateProcessing() {
            processingStepText.textContent = "Analyzing image quality...";
            progressIndicator.style.transform = `translateX(-0%)`;
            showProcessingSection();

            const steps = [
                { name: "Analyzing image quality...", duration: 1000 },
                { name: "Removing background...", duration: 1500 },
                { name: "Enhancing details...", duration: 1200 },
                { name: "Detecting defects...", duration: 2000 },
                { name: "Checking authenticity...", duration: 1000 },
                { name: "Generating report...", duration: 800 },
            ];

            for (let i = 0; i < steps.length; i++) {
                processingStepText.textContent = steps[i].name;
                await new Promise(resolve => setTimeout(resolve, steps[i].duration));
                const currentProgress = ((i + 1) / steps.length) * 100;
                progressIndicator.style.transform = `translateX(-${100 - currentProgress}%)`;
            }

            // --- IMPORTANT: This is where you'd replace simulation with a fetch to your Flask backend ---
            // Example:
            // const formData = new FormData();
            // formData.append('jewelry_image', uploadedFile);
            // try {
            //     const response = await fetch('/api/process-image', { method: 'POST', body: formData });
            //     const data = await response.json();
            //     if (response.ok) {
            //         const actualResult = {
            //             originalImage: URL.createObjectURL(uploadedFile),
            //             cleanedImage: data.cleaned_image_url, // URL from your Flask backend
            //             defects: data.defects, // Data from your Flask backend
            //             authenticityScore: data.authenticity_score,
            //             processingTime: data.processing_time
            //         };
            //         showAnalysisResults(actualResult);
            //     } else {
            //         alert(`Error from backend: ${data.error}`);
            //         showUploadSection();
            //     }
            // } catch (error) {
            //     console.error('Fetch error:', error);
            //     alert('Failed to connect to backend. Is your Flask server running?');
            //     showUploadSection();
            // }
            // --- END OF BACKEND FETCH EXAMPLE ---

            // Simulate analysis results (REMOVE THIS BLOCK WHEN USING ACTUAL BACKEND)
            const mockResult = {
                originalImage: URL.createObjectURL(uploadedFile),
                cleanedImage: 'https://placehold.co/800x600/0a0a0a/d4d4d4?text=Enhanced+Image', // Replace with actual processed image URL from backend
                defects: [
                    { type: "Minor scratch", confidence: 87, location: { x: 45, y: 30, width: 15, height: 8 }, severity: "low" },
                    { type: "Discoloration", confidence: 92, location: { x: 60, y: 55, width: 20, height: 12 }, severity: "medium" },
                    { type: "Inclusion", confidence: 95, location: { x: 20, y: 70, width: 10, height: 10 }, severity: "high" },
                ],
                authenticityScore: 94,
                processingTime: 6.5,
            };
            showAnalysisResults(mockResult);
            // --- END OF SIMULATION BLOCK ---
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', showUploadSection);
    </script>
</body>
</html>
